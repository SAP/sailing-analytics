# Malware Scanning

In our landscape, we use a default S3 bucket for media uploads from a multitude of application replica sets: ``media.sapsailing.com``. To protect our users from malware, this bucket's content is subject to scanning by AWS GuardDuty. See [here](https://eu-west-1.console.aws.amazon.com/guardduty/home?region=eu-west-1#/s3-malware-protection/bucket-details/c0cae6531cca07ef55bf/media.sapsailing.com) for the configuration of the service.

GuardDuty tags resources uploaded to the bucket using the ``GuardDutyMalwareScanStatus`` tag. The essential values are ``NO_THREATS_FOUND`` and ``UNSUPPORTED``. The latter is set, e.g., if the resource type is not recognized (for example, ``.apk`` files are not supported) or the resource size exceeds a limit of 5GB.

We use this tag's value to set up tag-based access control on that bucket. See [here](https://docs.aws.amazon.com/guardduty/latest/ug/tag-based-access-s3-malware-protection.html) for the corresponding AWS documentation on this subject. Based on the permission template found there, we have added two corresponding statements to the ``media.sapsailing.com`` bucket's permission document. In addition to the GuardDuty role we've added IAM administrator user principals so they have permission to override those tag values and see the resources irrespective their tag values.