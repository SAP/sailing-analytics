<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <link href='../../../../sailing-fontface-1.0.cache.css' media='screen' rel='stylesheet' title='Default stylesheet' type='text/css' />
    <link href='../../../main.css' media='screen' rel='stylesheet' title='Default stylesheet' type='text/css' />
    <link rel='icon' href='../../../../sap.ico' type='image/x-icon'>
    <title>SAP Sailing Analytics Webservices API Version 1.0</title>
</head>
<body>
<h1>SAP Sailing Analytics Webservices API Version 1.0</h1>
<h2>URL: /api/v1/scopemigration/movetoarchiveserver</h2>

<b>Description:</b>
<p>EXPERIMENTAL: This endpoint is used to move a leaderboard group set from a dedicated server to an archive server. The content
   is compared after the import and the comparison result is provided in the result object's <tt>compareServers</tt> field.
   Any remote server reference that may have pointed from the archive server to the content moved away from the dedicated server is removed
   or updated such that the content that was moved is no longer referenced through the remote server reference. Should any
   of these steps produce a non-OK response code, the overall response code will be that, and the <tt>responseCode</tt> fields
   of the individual objects reported in the response will show the repsonse of each sub-step.</p>
<p>Currently, the implementation status of this end point is still experimental. For example, the service does not wait for the completion
   of the master data import and will remove the remote reference regardless the result of the content comparison. Furthermore, no handling
   of any archive reverse proxy rules / redirects is performed, no database archiving happens, nor will any application replica set be
   shut down in the landscape. See also <a href="https://bugzilla.sapsailing.com/bugzilla/show_bug.cgi?id=5655">bug 5655</a>.</p>
<br/>
<table>
    <tr>
        <td>Webservice Type:</td>
        <td>POST</td>
    </tr>
    <tr>
        <td>Output format:</td>
        <td>json</td>
    </tr>
    <tr>
        <td>Mandatory parameters:</td>
        <td>
            <div>dedicated, the host name of the dedicated server (where the groups currently live).</div>
            <div>leaderboardgroupUUID[], a set of leaderboardgroup UUIDs.</div>
        </td>
    </tr>
    <tr>
        <td>Optional parameters:</td>
        <td>
            <div>archive, the host name of the archive server; defaults to <tt>www.sapsailing.com</tt></div>
            <div>user1, username for archive server. Provide <tt>password1</tt> with it. Alternatively, specify <tt>bearer1</tt>
                 or default to the authentication of this request.</div>
            <div>user2, username for dedicated server. Provide <tt>password2</tt> with it. Alternatively, specify <tt>bearer2</tt>
                 or default to the authentication of this request.</div>
            <div>password1, password for <tt>user1</tt> on archive server.</div>
            <div>password2, password for <tt>user2</tt> on dedicated server.</div>
            <div>bearer1, bearer token to authenticate a user on the archive server, to provide instead of <tt>username1</tt> and <tt>password1</tt>.</div>
            <div>bearer2, bearer token to authenticate a user on the dedicated server, to provide instead of <tt>username2</tt> and <tt>password2</tt>.</div>
            <div>override, tells whether existing content with equal identify on the importing side shall be overwritten by this action; defaults to "false"</div>
        </td>
    </tr>
    <tr>
        <td>Request method:</td>
        <td>POST</td>
    </tr>
    <tr>
        <td>Example:</td>
        <td>curl -X POST localhost:8889/sailingserver/api/v1/scopemigration/movetoarchiveserver -d "user1=admin" -d "user2=admin" -d "password2=admin" -d "password1=admin" -d "leaderboardgroupUUID[]=75e86618-8b0f-4291-9661-6b2a1fa47dff" -d "archive=localhost:8888" -d "dedicated=localhost:8889" -H "Authorization: Basic YWRtaW46YWRtaW4="<br>
        produces output:<pre>
        {
          "MDI": {
	         "leaderboardgroupsImported": [
	           {
	             "id": "75e86618-8b0f-4291-9661-6b2a1fa47dff",
	             "name": "MyTestEventWithStrangeCharact/er*s",
	             "events": [
	               "067c5d3b-2f11-42b4-8897-2b5cfbff3eeb",
	               "8414067e-6be0-4f74-b199-d2c79d01c3c1"
	             ]
	           }
	         ],
            "importedFrom": "localhost:8889",
            "override": false,
            "exportWind": true,
            "exportDeviceConfigs": false,
            "exportTrackedRacesAndStartTracking": true,
            "responseCode": 200
          },
          "compareServers": {
            "localhost:8888": [],
            "localhost:8889": [],
            "responseCode": 200
          },
          "remoteServerReferenceRemoved": {
            "remoteServerNameRemoved": "localhost:8888",
            "remoteServerUrlRemoved": "http://localhost:8888",
            "remoteServerEventsRemoved": [
              "Hempel World Cup Series 2019 - Genoa, Italy"
            ],
            "responseCode": 200
          }
        }
        </pre>
        </td>
    </tr>
</table>
<div style="height: 1em;"></div>
<a href="index.html">Back to Web Service Overview</a> 
</body>
</html>
