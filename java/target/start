#!/bin/sh

# source variables
. `pwd`/env.sh

# make some checks
if [[ ! -d "$JAVA_HOME" ]]; then
    echo "Could not find $JAVA_HOME. Aborting..."
    exit
fi

scriptdir=`dirname "$0"`
LIB_DIR=`pwd`/native-libraries
echo Script directory is $scriptdir and LIB_DIR is $LIB_DIR
nohup "$JAVA_HOME/bin/java" -XX:+UseMembar -D$SERVER_NAME -Dcom.sap.sailing.server.name=$SERVER_NAME -Djava.io.tmpdir=`pwd`/tmp -Dfile.encoding=cp1252 -Djetty.home=$scriptdir/configuration/jetty -Djava.util.logging.config.file=$scriptdir/configuration/logging.properties -Djava.library.path=$LIB_DIR -Xmx$MEMORY -jar plugins/org.eclipse.equinox.launcher_1.2.0.v20110502.jar -console $TELNET_PORT -configuration ./ -clean 2>/dev/null >/dev/null &
echo "Started $SERVER_NAME on port $TELNET_PORT - use telnet localhost $TELNET_PORT to connect to the OSGi console"
