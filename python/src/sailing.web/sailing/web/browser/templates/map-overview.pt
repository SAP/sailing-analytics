
<tal:if condition="view.listenerStarted()">
<div class="help">Google Map that displays current positions of waypoints and boats.</div>

<form>
    <br/>
    Event: 
    <select name="mapevent">
        <tal:for repeat="event view.allEvents()">
        <option value="${event.name}">${event.name}</option>
        </tal:for>
    </select>
    &nbsp;
    Race: 
    <select name="mapracename">
        <tal:for repeat="racename view.allRacesFor()">
        <option value="${racename}">${racename}</option>
        </tal:for>
    </select>

    <input id="map-loader" type="button" onclick="loadMap()" value="Load Map"/>

    <div id="map-data">
        &nbsp;
    </div>

    <script>
        function loadMap() {
            displayLoader('#map-data');
            GET('saveEventRace', {template: 'map-overview-details', 
                eventname: $('select[name=mapevent] option:selected').val(), 
                racename: $('select[name=mapracename] option:selected').val()}, 
            function(data) {
                $('#map-data').html(data)
            });
        }
    </script>
</form>

</tal:if>

<tal:if condition="not view.listenerStarted()">
    <b>Please start listener before working with the map!</b>
</tal:if>

