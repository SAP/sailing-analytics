
<div class="info" tal:define="wind view.currentWind()">
    Selected Race: <b>${view.currentRace().name}</b>&nbsp;Started: <b>${view.millisToDatetime(view.currentRace().start)}</b>&nbsp;Finish: <b>${view.millisToDatetime(view.currentRace().finish)}</b><br/><br/>
    Source: ${wind['currentwindsource']}<br/>
    Bearing (Race): ${view.currentRace().wind_bearing or 'N/A'}<br/>
    Speed (Race): ${view.currentRace().wind_speed or 'N/A'}<br/>

    <form method="POST" action="/++/windSettings" id="windform">
        <br/>
        Source:
        <select name="windsource">
            <option value="WEB" selected="${wind['currentwindsource'] == 'WEB' and 'selected' or None}">Custom</option>
            <option value="EXPEDITION" selected="${wind['currentwindsource']=='EXPEDITION' and 'selected' or None}">Expedition</option>
        </select>
        &nbsp;<input type="button" value="Set wind source" onclick="$('#windform').ajaxSubmit({data: {setsource:1}, success: loadWind}); return false;"/>
        <br/>
    </form>

    <br/>Last Wind 10 Tracks (EXPEDITION):<br/>
    <div style="margin: 2px 2px 2px 10px;">
        <tal:if condition="len(wind['EXPEDITION'])>0">
            <tal:for repeat="track wind['EXPEDITION'][:10]">
                <b>${view.millisToDatetime(track['timepoint'])}</b>&nbsp;
                Bearing: ${track['truebearingdeg']}&nbsp;
                Speed: ${track['knotspeed']}&nbsp;
                LatDeg: ${track.get('latdeg', 'N/A')}&nbsp;
                LngDeg: ${track.get('lngdeg', 'N/A')}<br/>
            </tal:for>
        </tal:if>

        <tal:else condition="len(wind['EXPEDITION'])==0">
            <i>Could not retrieve any wind tracks for EXPEDITION!</i>
        </tal:else>
    </div>

    <br/>Last Wind 10 Tracks (CUSTOM):<br/>
    <div style="margin: 2px 2px 2px 10px;">
        <tal:if condition="len(wind['WEB'])>0">
            <tal:for repeat="track wind['WEB'][:10]">
                <b>${view.millisToDatetime(track['timepoint'])}</b>&nbsp;
                Bearing: ${track['truebearingdeg']}&nbsp;
                Speed: ${track['knotspeed']}&nbsp;
                LatDeg: ${track.get('latdeg', 'N/A')}&nbsp;
                LngDeg: ${track.get('lngdeg', 'N/A')}<br/>
            </tal:for>
        </tal:if>

        <tal:else condition="len(wind['WEB'])==0">
            <i>Could not retrieve any wind tracks for WEB!</i>
        </tal:else>
    </div>
    <br/><br/>
    <form method="POST" action="/++/windSettings" id="windformset">
        <div class="field">
            <span>Timepoint:</span><br/>
            <input type="text" name="timeasmillis" value="${view.currentRace().start}"/>
        </div>
        <div class="field">
            <span>Bearing:</span><br/>
            <input type="text" name="truebearingdegrees"/>
        </div>
        <div class="field">
            <span>Speed:</span><br/>
            <input type="text" name="knotspeed"/>
        </div>
        <div class="field">
            <span>Latitude Degrees:</span><br/>
            <input type="text" name="latdeg"/>
        </div>
        <div class="field">
            <span>Longitude Degrees:</span><br/>
            <input type="text" name="lngdeg"/>
        </div>
        &nbsp;<input type="button" value="Set custom wind" onclick="$('#windformset').ajaxSubmit({data: {setcustom:1, success: loadWind}}); return false;"/>
    </form>
</div>
