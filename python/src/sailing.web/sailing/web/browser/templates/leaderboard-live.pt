<!DOCTYPE html>
<html>
  <head>
    <title>SAP Sailing Analytics</title>
    <link href='/moderator-static/screen.css' media='screen' rel='stylesheet' type='text/css'>
  </head>
  <body class='race-1' tal:define="event view.currentLeaderboardEvent(); 
                                    racebundles [event.races[i:i+3] for i in xrange(0, len(event.races), 3)];
                                    firstbundle racebundles[:3]; lastbundle racebundles[3:];
                                    columns view.configuredColumns('LEADERBOARD-%s' % request.params.get('c', 'F1'))"
                        tal:on-error="'No current leaderboard event defined!'">
    <div id='rootwrapper'>
      <div id='header'>
        <ul class='systeminfo'>
          <li id="eventline" class='message-0 active' style="font-size: 16px;">
          Kiel Week 2011, ${event.boatclass}<br/>
          <div id="Racenames" style="padding: 3px 0px 0px 0px;">${','.join(racebundles[int(request.params.get('r', 0))]).replace(event.boatclass, '').replace(' ', '').replace(',', ', ')}</div>
          </li>
          <li>
              <div class='function-btn-wrapper'>
                <ul class='function-btn'>
                  <li class='function-1 ${request.params.get("c", "F1") == "F1" and "active" or ""}'>
                  <a href='/@@/leaderboard-live?c=F1&r=${request.params.get("r", 0)}'>
                      SPDDST
                    </a>
                  </li>
                  <li class='function-1 ${request.params.get("c", "F1") == "F2" and "active" or ""}'>
                  <a href='/@@/leaderboard-live?c=F2&r=${request.params.get("r", 0)}'>
                      GAPETA
                    </a>
                  </li>
                </ul>
              </div>
          </li>
        </ul>
      </div>
      <div id='appinterface'>
        <!-- / THE LEFT BAR -->
        <div id='left-systembar'>
          <tal:for repeat="bundle firstbundle">
          <a class='slide-backward' href='?c=${request.params.get("c", "F1")}&r=${repeat["bundle"].index}'>
            <span class='race-count'>
              <ul class='race-bundle-${repeat["bundle"].number}'>
                <tal:for repeat="race bundle">
                <!-- XXX fix this to show current race -->
                <li class='race-${event.races.index(race)+1}'>
                    ${event.races.index(race)+1}
                </li>
                </tal:for>
              </ul>
            </span>
          </a>
          </tal:for>
          <div class='blue-table-btn'>
            <a href='javascript:;' onclick='showOverallWrap($(this))'></a>
          </div>
        </div>
        <!-- / THE RIGHT BAR -->
        <div id='right-systembar'>
          <tal:for repeat="bundle lastbundle">
          <a class='slide-forward' href='?c=${request.params.get("c", "F1")}&r=${repeat["bundle"].index}'>
            <span class='race-count'>
              <ul class='race-bundle-${repeat["bundle"].number}'>
                <tal:for repeat="race bundle">
                <li class='race-${event.races.index(race)+1}'>
                    ${event.races.index(race)+1}
                </li>
                </tal:for>
              </ul>
            </span>
          </a>
         </tal:for>
        </div>
        <!-- / YIELD THE MAIN INTERFACE -->
        <!-- / MAIN INTERFACE -->
        <div id='main-interface'>
          <div class='blue-table'>
              <a id="refresh-button" class='pause-btn' href='javascript:;' onclick='toggleListener($(this));'><img src='/static/images/ajax-loader-greybg.gif'/></a>
            <a class='sort-rank sort-desc' href='javascript:;' onclick='sortBy("current_rank", $(this))'></a>
            <table id='overall-clipping'>
              <tbody>
                <tal:for repeat="clpos range(1,21)">
                <tr class='${repeat["clpos"].even and "odd" or "even"}' id='clipping-${clpos}'>
                  <td id='clipping-${clpos}-1'>
                    <span>&nbsp;</span>
                  </td>
                  <td id='clipping-${clpos}-2'>
                    <span>&nbsp;</span>
                  </td>
                  <td id='clipping-${clpos}-3'>
                    <span>&nbsp;</span>
                  </td>
                </tr>
                </tal:for>
              </tbody>
            </table>
            <ul id='table-scrolling'>
              <li>
                <a class='table-scrolldown' href='#'></a>
              </li>
              <li>
                <a class='table-scrollup' href='#'></a>
              </li>
            </ul>
          </div>

          <!-- / WRAPPER FOR RACES -->
          <tal:for repeat='bundle racebundles[int(request.params.get("r", 0))]'>
          <div class='race' id='race-${repeat["bundle"].number}' tal:define='raceid repeat["bundle"].number'>
            <!-- / FIRST ELEMENT WITH LIST -->
            <div class='main-box'>
                <a class='main-box-active' href='javascript:;' onclick='toggleRace("${raceid}");'>
                <ul>
                  <tal:for repeat="rankrow range(1,21)">
                  <li id='race-${raceid}-rankrow-${rankrow}'></li>
                  </tal:for>
                </ul>
                <span id="race-">${racebundles[int(request.params.get('r', 0))].index(bundle)+1+(int(request.params.get('r', 0))*3)}</span>
              </a>
              <a class='main-box-sort sort-desc' href='javascript:;' onclick='sortBy("${raceid}", $(this))'></a>
            </div>

            <!-- START POINT -->
            <div class='leg-wrap' id="leg-start" style="display:none;" tal:define="markid 1">
              <div class='leg-box'>
              <span>S</span>

              <a class='leg-box-sort sort-desc' href='javascript:;'></a>
                <a class='leg-box-active' href='javascript:;' onclick='$(this).closest(".leg-wrap").find(".race-table").toggle();'>
                  <ul>
                      <tal:for repeat="markrow range(1,21)">
                      <li id='race-${raceid}-markstart-row-${markrow}'>&nbsp;</li>
                      </tal:for>
                  </ul>
                </a>
              </div>
              <table class='race-table' id='r1-m1' style="display:none;">
                <thead>
                  <tr>
                    <tal:for repeat="column columns">
                    <th colid='${repeat["column"].number}'>
                        <span>${column[1]}</span>
                    </th>
                    </tal:for>
                  </tr>
                </thead>
                <tbody>
                  <tr rowid='0'>
                    <tal:for repeat="column columns">
                    <td class='table-sorting' colid='${repeat["column"].number}'>
                        <a class='sort-desc' href='javascript:;' onclick='sortBy("${raceid},${markid},${repeat["column"].number}", $(this))'></a>
                    </td>
                    </tal:for>
                  </tr>
                  <tal:for repeat="valrow range(1,21)">
                  <tr class='${repeat["valrow"].even and "odd" or "even"}' id='race-${raceid}-valrow-${valrow}'>
                    <tal:for repeat="valrowpos range(len(columns))">
                    <td id='race-${raceid}-mark-${markid}-valrow-${valrow}-pos-${valrowpos}' >
                      <span>&nbsp;</span>
                    </td>
                    </tal:for>
                  </tr>
                  </tal:for>
                </tbody>
              </table>
            </div>

            <tal:for repeat="leg event.marks[int(raceid)-1]">
            <div class='leg-wrap' id="leg-${repeat['leg'].number}" tal:define='markid repeat["leg"].number+1' style="display:none;">
              <!-- / SECOND ELEMENT WITH LIST -->
              <div class='leg-box'>
                  <span tal:condition="not repeat['leg'].end">M${markid-1}</span>
                  <span tal:condition="repeat['leg'].end">F</span>

              <a class='leg-box-sort sort-desc' href='javascript:;' onclick='sortBy("${raceid},${markid-1}", $(this))'></a>
                <a tal:omit-tag="repeat['leg'].end" class='leg-box-active' href='javascript:;' onclick='$(this).closest(".leg-wrap").find(".race-table").toggle();'>
                  <ul>
                      <tal:for repeat="markrow range(1,21)">
                          <li id='race-${raceid}-mark-${markid}-row-${markrow}'>&nbsp;</li>
                      </tal:for>
                  </ul>
                </a>
              </div>

              <table class='race-table' id='r1-m1' style="display:none;" tal:condition="not repeat['leg'].end">
                <thead>
                  <tr>
                    <tal:for repeat="column columns">
                    <th colid='${repeat["column"].number}'>
                        <span>${column[1]}</span>
                    </th>
                    </tal:for>
                  </tr>
                </thead>
                <tbody>
                  <tr rowid='0'>
                    <tal:for repeat="column columns">
                    <td class='table-sorting' colid='${repeat["column"].number}'>
                        <a class='sort-desc' href='javascript:;' onclick='sortBy("${raceid},${markid},${repeat["column"].number}", $(this))'></a>
                    </td>
                    </tal:for>
                  </tr>
                  <tal:for repeat="valrow range(1,21)">
                  <tr class='${repeat["valrow"].even and "odd" or "even"}' id='race-${raceid}-valrow-${valrow}'>
                    <tal:for repeat="valrowpos range(len(columns))">
                    <td id='race-${raceid}-mark-${markid}-valrow-${valrow}-pos-${valrowpos}' >
                      <span>&nbsp;</span>
                    </td>
                    </tal:for>
                  </tr>
                  </tal:for>
                </tbody>
              </table>
            </div>
            </tal:for>
          </div>
          </tal:for>
        </div>

        <div id='overall-wrap' style="display:none;">
          <table id='overall'>
            <thead>
              <tr>
                <th colid='1'>
                  <span>Rank</span>
                </th>
                <th colid='2'>
                  <span>Flag</span>
                </th>
                <th colid='3'>
                  <span>Skipper</span>
                </th>
                <th colid='4'>
                  <span>Total Points</span>
                </th>
                <!--<th colid='5'>
                  <span>Net Points</span>
              </th>-->
              </tr>
            </thead>
            <tbody>
              <tal:for repeat="compcolumns range(1,21)">
              <tr class='${repeat["compcolumns"].even and "odd" or "even"}' rowid='1'>
                <td colid='1'>
                    <span id="competitor-global-rank-${repeat['compcolumns'].number}">1</span>
                </td>
                <td colid='2'>
                  <span id="competitor-global-nationality-${repeat['compcolumns'].number}">30</span>
                </td>
                <td colid='3'>
                  <span id="competitor-global-name-${repeat['compcolumns'].number}">20</span>
                </td>
                <td colid='4'>
                  <span id="competitor-global-total-${repeat['compcolumns'].number}">10</span>
                </td>
                <!--<td colid='5'>
                  <span id="competitor-global-net-${repeat['compcolumns'].number}">10</span>
                </td>-->
              </tr>
              </tal:for>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </body>
  <!--<script src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js'></script>-->

  <script>
      global_colmode = 'LEADERBOARD-${request.params.get('c', 'F1')}';
      global_race = '${(int(request.params.get('r', 0))*3)+1}:${((int(request.params.get('r', 3))*3)+1)+2}';
  </script>

  <script src='/moderator-static/jquery.js' type='text/javascript'></script>
  <script src='/moderator-static/app.js' type='text/javascript'></script>

</html>
