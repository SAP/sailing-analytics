ProxyHCExpr ok2 {%{REQUEST_STATUS} =~ /^[2]/}

Define ARCHIVE .....
Define FAILOVER ....


<!--new archive methods format?-->
<Virtualhost *:80>
ServerName $HOSTNAME
<Proxy balancer://myset>
    BalancerMember http://${ARCHIVE}:8888  hcmethod=GET hcexpr=ok2 hcuri=/gwt/status
    BalancerMember http://${FAILOVER}:8880 status=+H
    ProxySet lbmethod=bytraffic
</Proxy>

ProxyPass "/"  "balancer://myset/"
ProxyPassReverse "/"  "balancer://myset/"

</VirtualHost>


<!--Because it is pinging the ip itself, we will need to implement in a gwt?-->
<!--Currently works by requesting site and then disabling that site for "retry" time.-->
<!--how many health checks fail before considered unhealthy?-->
<!-- <Macro ArchiveRewrite>
	Use Rewrite ${ARCHIVE_IP} 8888
</Macro>

<Macro Rewrite $IP $PORT>
	ProxyPass "/" "http://$IP:$PORT/" nocanon
        # This is what it was before, requiring AllowEncodedSlashes On instead of NoDecode:
	# RewriteRule ^/(.*)$ http://$IP:$PORT/$1 [P,L]
        ProxyPassReverse / http://$IP:$PORT/
	ProxyPreserveHost On
</Macro> -->