
# Default - NEVER move this or change anything here
<VirtualHost *:80>
	ServerName sapsailing.com
	RedirectPermanent / https://www.sapsailing.com/	
</VirtualHost>

<VirtualHost *:80>
	ServerName jobs.sapsailing.com
	RedirectPermanent / https://jobs.sapsailing.com/	
</VirtualHost>

<VirtualHost *:443>
	ServerName jobs.sapsailing.com
	Use SSL
	CustomLog logs/jobs_log combined
	DocumentRoot /home/trac/static/jobs
	<Directory /home/trac/static/jobs>
	    Options Indexes FollowSymLinks MultiViews
	    AllowOverride All
	    Order allow,deny
	    allow from all
	</Directory>
</VirtualHost>

<VirtualHost *:80>
	ServerName a.dummy.sapsailing.com
	RewriteEngine on
	RewriteCond %{HTTP:X-Forwarded-Proto} !https
	RewriteCond %{HTTPS} off
	RewriteRule ^.*$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301,NE]
</VirtualHost>

<VirtualHost *:80>
        ServerName kw2013.sapsailing.com
        RedirectPermanent / http://livecenter.kieler-woche.de/en/
</VirtualHost>

# P2 repository
<VirtualHost *:80>
	ServerName p2.sapsailing.com
	CustomLog logs/services_log combined
	Alias /p2 /home/trac/p2-repositories
	<Directory /home/trac/p2-repositories>
	    Options Indexes FollowSymLinks MultiViews
	    AllowOverride None
	    Order allow,deny
	    allow from all
	</Directory>
</VirtualHost>

<VirtualHost *:443>
	ServerName p2.sapsailing.com
	Use SSL
	CustomLog logs/services_log combined
	Alias /p2 /home/trac/p2-repositories
	<Directory /home/trac/p2-repositories>
	    Options Indexes FollowSymLinks MultiViews
	    AllowOverride None
	    Order allow,deny
	    allow from all
	</Directory>
</VirtualHost>

# Git Viewer -->
<VirtualHost *:80>
	ServerName gitlist.sapsailing.com
	CustomLog logs/services_log combined
	DocumentRoot /var/www/gitlist
	AddHandler php5-script .php
	AddType text/html .php
	DirectoryIndex index.php
	<Directory /var/www/gitlist>
	    Options Indexes FollowSymLinks MultiViews
	    AllowOverride All
	    Order allow,deny
	    allow from all
	</Directory>
</VirtualHost>

# Maven Repositories -->
<VirtualHost *:80>
	ServerName maven.sapsailing.com
	CustomLog logs/services_log combined
	Alias /maven /home/trac/maven-repositories
	<Directory /home/trac/maven-repositories>
	    Options Indexes FollowSymLinks MultiViews
	    AllowOverride None
	    Order allow,deny
	    allow from all
	</Directory>
</VirtualHost>

<VirtualHost *:443>
	ServerName maven.sapsailing.com
	Use SSL
	CustomLog logs/services_log combined
	Alias /maven /home/trac/maven-repositories
	<Directory /home/trac/maven-repositories>
	    Options Indexes FollowSymLinks MultiViews
	    AllowOverride None
	    Order allow,deny
	    allow from all
	</Directory>
</VirtualHost>

# Bugzilla -->
Alias /bugzilla/var/lib/bugzilla/data/webdot /var/lib/bugzilla/data/webdot
Alias /bugzilla /usr/share/bugzilla

<Directory /usr/share/bugzilla>
  AddHandler cgi-script .cgi
  Options +Indexes +ExecCGI +FollowSymLinks
  DirectoryIndex index.cgi index.html
  AllowOverride Limit Options FileInfo
  AddType application/vnd.mozilla.xul+xml .xul
  AddType application/rdf+xml .rdf
</Directory>

<VirtualHost *:80>
	ServerName bugzilla.sapsailing.com
	RedirectPermanent / https://bugzilla.sapsailing.com/
</VirtualHost>

<VirtualHost *:443>
	ServerName bugzilla.sapsailing.com
	Use SSL
	CustomLog logs/services_log combined
	#ServerPath /bugzilla
	#DocumentRoot /usr/share/bugzilla
	Alias /bugzilla /usr/share/bugzilla
	<Directory /usr/share/bugzilla>
	  AddHandler cgi-script .cgi
	  Options +Indexes +ExecCGI +FollowSymLinks
	  DirectoryIndex index.cgi
	  AllowOverride Limit Options FileInfo
	</Directory>
</VirtualHost>

# Various Services like p2 repository and bugzilla -->
<VirtualHost *:80>
	ServerName bugzilla.sapsailing.com

	CustomLog logs/services_log combined
	#ServerPath /bugzilla
	#DocumentRoot /usr/share/bugzilla

	Alias /bugzilla /usr/share/bugzilla
	Alias /p2 /home/trac/p2-repositories
	Alias /maven /home/trac/maven-repositories
	Alias /maven-riccardo /home/riccardo/maven-repositories
	Alias /mrtg /var/www/mrtg

	<Directory /var/www/mrtg >
	  Options Indexes FollowSymLinks MultiViews
	  DirectoryIndex index.html
		    AllowOverride None
		    Order allow,deny
		    Allow from all
	</Directory>

	<Directory /usr/share/bugzilla>
	  AddHandler cgi-script .cgi
	  Options +Indexes +ExecCGI +FollowSymLinks
	  DirectoryIndex index.cgi
	  AllowOverride Limit Options FileInfo
	</Directory>

	<Directory /home/trac/p2-repositories>
		  Options Indexes FollowSymLinks MultiViews
		    AllowOverride None
		    Order allow,deny
		    allow from all
	</Directory>

	<Directory /home/trac/maven-repositories>
		  Options Indexes FollowSymLinks MultiViews
		    AllowOverride None
		    Order allow,deny
		    allow from all
	</Directory>
	<Directory /home/riccardo/maven-repositories>
		  Options Indexes FollowSymLinks MultiViews
		    AllowOverride None
		    Order allow,deny
		    allow from all
	</Directory>
</VirtualHost>

# Error pages -->
<VirtualHost *:80>
	ServerName status.sapsailing.com
	DocumentRoot /var/www/errorpages

	<Directory /var/www/errorpages >
	    Options Indexes FollowSymLinks MultiViews
	    DirectoryIndex index.html
	    AllowOverride None
	    Order allow,deny
	    Allow from all
	</Directory>

	<Location /internal-server-status>
	    SetHandler server-status
	    Order deny,allow
	    Deny from all
	    Allow from all
	    #Allow from 46.142.162.18 localhost 127.0.0.1 *
	</Location>

	CustomLog logs/services_log combined
</VirtualHost>

# PIWIK analytics -->
<VirtualHost *:80>
	ServerName analysis.sapsailing.com
	Alias / /var/www/piwik/
	<Directory /var/www/piwik/ >
	    Options Indexes FollowSymLinks MultiViews
	    DirectoryIndex index.php
	    AllowOverride None
	    Order allow,deny
	    allow from all
	</Directory>
	CustomLog logs/services_log combined
</VirtualHost>

# Wiki -->
<VirtualHost *:80>
	ServerName wiki.sapsailing.com
	RedirectPermanent / https://wiki.sapsailing.com/
</VirtualHost>

<VirtualHost *:443>
	ServerName wiki.sapsailing.com
	Use SSL
	RewriteEngine on
	RewriteRule ^/(.*) http://localhost:4567/$1 [P,L]
	ProxyPassReverse / http://localhost:4567/
	CustomLog logs/services_log combined
</VirtualHost>

<VirtualHost *:80>
	ServerName mrtg.sapsailing.com
	RedirectPermanent / http://static.sapsailing.com/
</VirtualHost>

<VirtualHost *:80>
	ServerName stg.static.sapsailing.com
	RedirectPermanent / http://static.sapsailing.com/
</VirtualHost>

<VirtualHost *:80>
	ServerName releases.sapsailing.com
	DocumentRoot /home/trac/releases

	  <Directory /home/trac/releases>
	    Order Deny,Allow
	    Allow from all
	    Options Indexes FollowSymLinks -ExecCGI
	    AllowOverride All
	  </Directory>
	CustomLog logs/services_log combined
</VirtualHost>

# Static files -->
<VirtualHost *:80>
	ServerName static.sapsailing.com
	DocumentRoot /var/www/static

	  <Directory /var/www/static>
	    Order Deny,Allow
	    Allow from all
	    Options -Indexes FollowSymLinks ExecCGI
	    AllowOverride All
	  </Directory>
	CustomLog logs/services_log combined
</VirtualHost>

<VirtualHost *:80>
	ServerName erlebniswelt.sapsailing.com
	DocumentRoot /var/www/static/fcb

	<Directory /var/www/static/fcb>
	    Options +Indexes -FollowSymLinks +MultiViews
	    AllowOverride None
	    Order allow,deny
	    allow from all
	</Directory>
</VirtualHost>

<VirtualHost *:443>
	ServerName static.sapsailing.com
	Use SSL
	DocumentRoot /var/www/static

	  <Directory /var/www/static>
	    Order Deny,Allow
	    Allow from all
	    Options -Indexes FollowSymLinks ExecCGI
	    AllowOverride All
	  </Directory>
	CustomLog logs/services_log combined
</VirtualHost>

<VirtualHost *:80>
  ServerName dev.sapsailing.com
  RedirectPermanent / https://dev.sapsailing.com/	
</VirtualHost>

<VirtualHost *:80>
  ServerName hudson.sapsailing.com
  RedirectPermanent / https://hudson.sapsailing.com/	
</VirtualHost>

<VirtualHost *:443>
  ServerName hudson.sapsailing.com
  Use SSL
  RewriteEngine on
  RewriteRule ^/(.*) http://172.31.28.17:8080/$1 [P,L]
  ProxyPassReverse / http://172.31.28.17:8080/
	CustomLog logs/services_log combined
</VirtualHost>

<VirtualHost *:80>
  ServerName jenkins.sapsailing.com
  RedirectPermanent / https://jenkins.sapsailing.com/	
</VirtualHost>

<VirtualHost *:443>
  ServerName jenkins.sapsailing.com
  Use SSL
  RewriteEngine on
  RewriteRule ^/(.*) http://172.31.17.141:8080/$1 [P,L]
  ProxyPassReverse / http://172.31.17.141:8080/
	CustomLog logs/services_log combined
</VirtualHost>

